var app=angular.module("dpApp",["ui.router"]);app.config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/home"),a.state("home",{url:"/home",templateUrl:"pages/home.html",controller:"dpHomeCtrl"}).state("404",{url:"/404",templateUrl:"pages/404.html"}).state("membersList",{url:"/members-list",templateUrl:"pages/members-list.html"}).state("aboutUs",{url:"/about-us",templateUrl:"pages/about-us.html"}).state("images",{url:"/images/:id",templateUrl:"pages/images.html",controller:"dpImageCtrl"})}]),app.service("service.main",function(){var a=["Senthil","Kumar"];return{names:a}}),app.service("settings",function(){var a={sites:[{blogId:"7833828309523986982",blogURL:"http://www.desipixer.in/",category:1}]};return{maxResults:100,startIndex:1,blogName:"http://www.dp.in",blogId:"7833828309523986982",publish:a}}),app.service("service.auth",["$q",function(a){var b="AIzaSyAb3tFTPvsduIR2xopIVpYhwKMQ5ac_5Po",c="215192364453-1vbjuf6f3r0vka9b5q0hj2mqj212dr9o.apps.googleusercontent.com",d=function(){return b},e=a.defer(),f={getKey:function(){return b},getClientSecret:function(){return c},logMeIn:function(){var a=(this.getKey(),{client_id:this.getClientSecret(),immediate:!1,response_type:"token",scope:"http://www.blogger.com/feeds/"});gapi.auth.authorize(a,this.callbackFn)},callbackFn:function(a){this.accessToken=a.access_token,e.resolve(a)},getToken:function(){return this.logMeIn(),e.promise},getAuthToken:function(a){return null!=a?"Bearer ".concat(a.access_token):null},accessToken:null};return{getAuthKey:d,blogger:f}}]),app.service("service.url",["$http","service.auth","settings",function(a,b,c){var d=function(a){if(null!=a){var b="?";return Object.keys(a).forEach(function(c,d){b+=c.concat("=").concat(a[c]).concat("&")}),b.substring(0,b.length-1)}},e=function(a){return a=null!==a?a:c.blogId,"https://www.googleapis.com/blogger/v3/blogs/".concat(a).concat("/posts?fetchImages=true&key=").concat(b.getAuthKey())},f=function(a,b,e){b=null!==b?b:c.startIndex,e=null!==e?e:c.maxResults,a=null!==a?a:c.blogId;var f={"start-index":b,"max-results":e,alt:"json",callback:"JSON_CALLBACK"};return"https://www.blogger.com/feeds/".concat(a).concat("/posts/default").concat(d(f))},g=function(a){var c={key:b.getAuthKey(),url:a};return"https://www.googleapis.com/blogger/v3/blogs/byurl".concat(d(c))},h=function(a,b,e,g){if(void 0==g||""==g)return f(a,b,e);b=null!==b?b:c.startIndex,e=null!==e?e:c.maxResults,a=null!==a?a:c.blogId;var h={"start-index":b,"max-results":e,q:g,alt:"json",callback:"JSON_CALLBACK"};return"https://www.blogger.com/feeds/".concat(a).concat("/posts/default").concat(d(h))},i=function(a){return"https://www.googleapis.com/blogger/v3/blogs/".concat(a).concat("/posts")};return{urlForBlogId:g,urlForBlogFeed:f,urlForBlogDetails:e,urlForSearchText:h,objToString:d,getPostUrl:i}}]),app.service("service.util",["$http","settings","service.url",function(a,b,c){this.sessionBlog=[];var d=function(a){var b=[],c=a.match(/<img\s[^>]*?src\s*=\s*['\"]([^'\"]*?)['\"][^>]*?>/g);return void 0!=c&&c.length>0&&c.forEach(function(a,c){var d=a.match(/(https?:\/\/.*\.(?:png|jpg))/gi);if(void 0!=d&&d.length>0&&-1!==d[0].indexOf("blogspot.com")){var e=d[0].split("/"),f=e.splice(e.length-2,1);largeIMG=d[0].replace(f,"s1600"),b.push(largeIMG)}}),b},e=function(a){if(void 0!=a){if(a.hasOwnProperty("feed")&&a.feed.hasOwnProperty("entry")){console.log("Entries : "+a.feed.entry.length);var b=[],c=a.feed.entry;return c.forEach(function(a,c){var e={};e.title=void 0!==a.title.$t?a.title.$t:null,e.link=void 0!==a.link?a.link[a.link.length-1].href:null,e.id=void 0!==a.id.$t?a.id.$t.match(/\d+/g)[1].concat("-").concat(a.id.$t.match(/\d+/g)[2]):null,e.images=void 0!==a.content.$t?d(a.content.$t):[],e.thumb=0!==e.images.length?e.images[0].replace("s1600","s480"):[],e.published=a.published.$t,e.updated=a.published.$t,b.push(e)}),this.sessionBlog=b,b}return[]}},f=function(b){return a.get(c.urlForBlogId(b))},g=function(b,d){var e=c.urlForSearchText(b,null,null,d);return a.jsonp(e)},h=function(b,d,e){var f=c.urlForBlogFeed(b,d,e);return a.jsonp(f)};return{getEntries:h,processBlogObj:e,searchSite:f,searchText:g,sessionBlog:this.sessionBlog}}]),app.service("service.sites",function(){var a=[{blogId:"7833828309523986982",blogURL:"http://www.desipixer.in/",category:1},{blogId:"3079987222818050451",blogURL:"http://movies.cinema65.com/",category:1},{blogId:"4846859112009281783",blogURL:"http://rockingfunimages.blogspot.com/",category:1},{blogId:"719302156971941098",blogURL:"http://hq-bollywood.blogspot.com/",category:1},{blogId:"1579799827781024268",blogURL:"http://www.telugupeopleadda.com/",category:1},{blogId:"5935905342569794143",blogURL:"http://sabhothimages.blogspot.com/",category:1},{blogId:"3293309843232706023",blogURL:"http://www.searchtamilmovies.com/",category:1},{blogId:"2951969169923408846",blogURL:"http://fultohot.blogspot.com/",category:1},{blogId:"4846859112009281783",blogURL:"http://www.celebsnext.com/",category:2},{blogId:"4040041419446016295",blogURL:"http://cinewaaradhi.blogspot.com",category:1},{blogId:"2222622162581355396",blogURL:"http://www.tufan9.com/",category:1},{blogId:"5338625676592862668",blogURL:"http://cinytown.blogspot.com/",category:1},{blogId:"3430584311590741572",blogURL:"http://tollywoodboost.blogspot.com/",category:1},{blogId:"5186853171678363994",blogURL:"https://latestmovieimagess.blogspot.com",category:1},{blogId:"4758457913364204558",blogURL:"http://cinestargallery.blogspot.com/",category:1}];return{sites:a}}),app.service("service.post",["service.auth","service.util","service.url","$http","$q","settings",function(a,b,c,d,e,f){var g=function(a,b){var c="";if(a.length>0){var d=b;c="<div>",a.forEach(function(a,b){c=c.concat("<img src='").concat(a).concat("' title='").concat(d).concat("' class='desipixer' />")}),c+="</div>"}return c},h=function(){return console.log("called login service"),a.blogger.getToken()},i=function(){return a.blogger.accessToken()},j=function(a,b){var c=a.title,d=a.images,e=g(d,c);return k(e,c,b)},k=function(b,d,e){var g=f.publish.sites[0].blogId,h=c.getPostUrl(g),i={content:b,title:d},j={headers:{Authorization:a.blogger.getAuthToken(e)}};return l(h,i,j)},l=function(a,b,c){var f=e.defer();return d.post(a,b,c).success(function(a,b){f.resolve(a)}).error(function(a){console.log(a)}),f.promise};return{getPostObj:k,createPostRequest:j,loggedIn:i,login:h,publishPost:l,generatePostHTML:g}}]);var clipboard=new Clipboard(".btn");document.onkeydown=function(a){8==a.keyCode&&"TEXTAREA"!=e.target.tagName&&"INPUT"!=e.target.tagName&&(a.preventDefault(),history.back(-1))},app.directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}}),app.controller("dpMainCtrl",["$scope","service.sites","service.main",function(a,b,c){a.sites=b.sites,a.names=c.names}]),app.controller("dpHomeCtrl",["$scope","service.sites","service.util","settings",function(a,b,c,d){a.title="Home Page",a.sites=b.sites,c.sessionBlog.length>0?a.entries=c.sessionBlog:c.getEntries(null,d.startIndex,d.maxResults).success(function(b){var d=c.processBlogObj(b);a.entries=d}).error(function(a){console.log(a)}),a.selSiteChange=function(){c.getEntries(a.selSite,null,null).success(function(b){var d=c.processBlogObj(b);a.entries=d}).error(function(a){console.log(a)})},a.searchSite=function(){c.searchSite(a.txtSearchSite).success(function(b){a.selSite=b.id,a.selSiteChange();var c={blogId:b.id,blogURL:a.txtSearchSite,category:1};console.log(c.toString())}).error(function(a){console.log("Error during searching site : "+a)})},a.searchKeyWords=function(){var b=void 0!==a.selSite.blogId?a.selSite.blogId:a.selSite;c.searchText(b,a.txtSearch).success(function(b){var d=c.processBlogObj(b);a.entries=d})},a.getPreviousPosts=function(){if(!(d.startIndex<=1)){d.startIndex-=d.maxResults;var b=void 0!==a.selSite.blogId?a.selSite.blogId:a.selSite;c.getEntries(b,d.startIndex,d.maxResults).success(function(b){var d=c.processBlogObj(b);a.entries=d}).error(function(a){console.log(a)})}},a.getNextPosts=function(){d.startIndex+=d.maxResults;var b=void 0!==a.selSite.blogId?a.selSite.blogId:a.selSite;c.getEntries(b,d.startIndex,d.maxResults).success(function(b){var d=c.processBlogObj(b);a.entries=d}).error(function(a){console.log(a)})},a.titleSort=function(){c.sessionBlog=a.entries=_.sortBy(a.entries,function(a){return a.title})},a.shuffleArray=function(){c.sessionBlog=a.entries=_.shuffle(a.entries)}}]),app.controller("dpImageCtrl",["$scope","$stateParams","service.util","service.post",function(a,b,c,d){var e=void 0!==b.id?b.id:"default",f=_.filter(c.sessionBlog,function(a){return a.id==e});f.length>0&&(f[0].images=_.uniq(f[0].images)),a.postObj=f.length>0?f[0]:[],a.postContent=d.generatePostHTML(a.postObj.images,a.postObj.title),a.publishPost=function(){d.login().then(function(b){d.createPostRequest(a.postObj,b).then(function(a){angular.element(document.querySelector("#divPostStatus")).text("POSTED"),console.log(a)},function(a){angular.element(document.querySelector("#divPostStatus")).text("ERROR"),console.log(a)})},function(a){console.log(a)})},a.goToUrl=function(){var b=a.postObj.link,c=window.open(b,"_blank");c.focus()},a.shareToGplus=function(){var b="https://plus.google.com/share?url=".concat(a.postObj.link),c=window.open(b,"_blank","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600");c.focus()}}]);